apiVersion: platform.confluent.io/v1beta1
kind: Kafka
metadata:
  name: kafka-west
  namespace: west
  annotations:
    platform.confluent.io/zookeeper-myid-offset: "20"
spec:
  configOverrides:
    server:
      - client.rack=west
      - confluent.license.topic.replication.factor=3
      - replica.selector.class=org.apache.kafka.common.replica.RackAwareReplicaSelector
      - session.timeout.ms=30000
      - max.poll.interval.ms=300000
      - zookeeper.connection.timeout.ms=60000
  dependencies:
    zookeeper:
      endpoint: 'zookeeper-west-0.zookeeper-west.west.svc.cluster.local:2181,zookeeper-west-1.zookeeper-west.west.svc.cluster.local:2181,local-cluster.zookeeper-east-0-internal.east.svc.clusterset.local:2181,local-cluster.zookeeper-east-1-internal.east.svc.clusterset.local:2181,local-cluster.zookeeper-east-2-internal.east.svc.clusterset.local:2181'
  tls:
    autoGeneratedCerts: true
  image:
    application: 'confluentinc/cp-server:7.3.3'
    init: 'confluentinc/confluent-init-container:2.5.2'
  listeners:
    internal:
      authentication:
        jaasConfig:
          secretRef: credential
        type: plain
      tls:
        enabled: true
  dataVolumeCapacity: 100Gi
  metricReporter:
    tls:
      enabled: true
    enabled: true
    bootstrapEndpoint: kafka-west.west.svc.cluster.local:9072
    authentication:        
      jaasConfig:
        secretRef: metric-creds
      type: plain
  replicas: 2
